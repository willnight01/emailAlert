import{_ as ee,g as i,c as R,o as x,d as a,t as h,F as oe,C as se,e,w as t,h as p,N as Z,r as k,L as U,l as q,O as ve,q as K,a as ue,K as le,G as be,a6 as fe,a7 as ye,s as pe,E as z,W as ge,P as we,J as _e,n as xe,v as he,B as Ve,a8 as Se,T as ke,U as De}from"./index-Cq749T7a.js";import{t as J}from"./index-DZNyvenB.js";const Te={class:"variable-category"},$e={class:"category-header"},Ce={class:"category-description"},Ee={class:"variable-list"},Me={class:"variable-info"},je={class:"variable-name"},Ae={class:"variable-description"},Ne={class:"variable-example"},Ie={class:"example-value"},ze={__name:"VariableCategory",props:{title:{type:String,required:!0},description:{type:String,required:!0},variables:{type:Array,required:!0}},emits:["insert"],setup(b,{emit:j}){const u=j,D=y=>{u("insert",y)},g=y=>`{{${y}}}`;return(y,f)=>{const _=i("el-button");return x(),R("div",Te,[a("div",$e,[a("h3",null,h(b.title),1),a("p",Ce,h(b.description),1)]),a("div",Ee,[(x(!0),R(oe,null,se(b.variables,T=>(x(),R("div",{key:T.name,class:"variable-item"},[a("div",Me,[a("div",je,[a("code",null,h(g(T.name)),1),e(_,{size:"small",type:"primary",link:"",onClick:A=>D(T.name)},{default:t(()=>f[0]||(f[0]=[p(" æ’å…¥ ")])),_:2,__:[0]},1032,["onClick"])]),a("div",Ae,h(T.description),1),a("div",Ne,[f[1]||(f[1]=a("span",{class:"example-label"},"ç¤ºä¾‹å€¼ï¼š",-1)),a("span",Ie,h(T.example),1)])])]))),128))])])}}},X=ee(ze,[["__scopeId","data-v-af9c5fd5"]]),Re={class:"variable-help"},Ue={class:"help-header"},Pe={class:"examples-section"},Le={class:"example-items"},Fe={class:"example-header"},He={class:"example-description"},Be={class:"example-template"},qe={__name:"VariableHelp",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","insert"],setup(b,{emit:j}){const u=b,D=j,g=Z({get:()=>u.modelValue,set:S=>D("update:modelValue",S)}),y=k("email"),f=[{name:".Email.Subject",description:"é‚®ä»¶ä¸»é¢˜",example:"ã€å‘Šè­¦ã€‘ç³»ç»Ÿå¼‚å¸¸é€šçŸ¥"},{name:".Email.Sender",description:"å‘ä»¶äººé‚®ç®±åœ°å€",example:"monitor@example.com"},{name:".Email.Content",description:"é‚®ä»¶æ­£æ–‡å†…å®¹",example:"æ•°æ®åº“è¿æ¥å¼‚å¸¸ï¼Œè¯·ç«‹å³å¤„ç†"},{name:".Email.HTMLContent",description:"é‚®ä»¶HTMLå†…å®¹",example:"<p>æ•°æ®åº“è¿æ¥å¼‚å¸¸ï¼Œè¯·ç«‹å³å¤„ç†</p>"},{name:".Email.ReceivedAt",description:"é‚®ä»¶æ¥æ”¶æ—¶é—´",example:"2024-01-15 14:30:25"},{name:".Email.Size",description:"é‚®ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰",example:"1024"},{name:".Email.MessageID",description:"é‚®ä»¶å”¯ä¸€æ ‡è¯†ç¬¦",example:"<123456@example.com>"}],_=[{name:".Alert.ID",description:"å‘Šè­¦ID",example:"1001"},{name:".Alert.Subject",description:"å‘Šè­¦ä¸»é¢˜ï¼ˆå¤„ç†åï¼‰",example:"ã€å‘Šè­¦ã€‘ç³»ç»Ÿå¼‚å¸¸é€šçŸ¥"},{name:".Alert.Status",description:"å‘Šè­¦çŠ¶æ€",example:"active"},{name:".Alert.Content",description:"å‘Šè­¦å†…å®¹ï¼ˆå¤„ç†åï¼‰",example:"æ•°æ®åº“è¿æ¥å¼‚å¸¸ï¼Œè¯·ç«‹å³å¤„ç†"},{name:".Alert.CreatedAt",description:"å‘Šè­¦åˆ›å»ºæ—¶é—´",example:"2024-01-15 14:30:25"},{name:".Alert.ReceivedAt",description:"é‚®ä»¶æ¥æ”¶æ—¶é—´",example:"2024-01-15 14:30:25"}],T=[{name:".Rule.ID",description:"è§„åˆ™ID",example:"1"},{name:".Rule.Name",description:"è§„åˆ™åç§°",example:"ç”Ÿäº§ç¯å¢ƒå‘Šè­¦è§„åˆ™"},{name:".Rule.MatchType",description:"åŒ¹é…ç±»å‹",example:"keyword"},{name:".Rule.MatchValue",description:"åŒ¹é…å€¼",example:"é”™è¯¯,å¼‚å¸¸,å‘Šè­¦"},{name:".Rule.Priority",description:"è§„åˆ™ä¼˜å…ˆçº§",example:"9"},{name:".Rule.Description",description:"è§„åˆ™æè¿°",example:"ç”¨äºåŒ¹é…ç”Ÿäº§ç¯å¢ƒçš„å‘Šè­¦ä¿¡æ¯"}],A=[{name:".Mailbox.ID",description:"é‚®ç®±ID",example:"1"},{name:".Mailbox.Name",description:"é‚®ç®±åç§°",example:"ç›‘æ§é‚®ç®±"},{name:".Mailbox.Email",description:"é‚®ç®±åœ°å€",example:"monitor@example.com"},{name:".Mailbox.Host",description:"IMAPæœåŠ¡å™¨åœ°å€",example:"imap.example.com"},{name:".Mailbox.Port",description:"IMAPç«¯å£",example:"993"}],O=[{name:".System.AppName",description:"åº”ç”¨åç§°",example:"ç»Ÿä¸€é‚®ä»¶å‘Šè­¦å¹³å°"},{name:".System.AppVersion",description:"åº”ç”¨ç‰ˆæœ¬",example:"v1.0.0"},{name:".System.ServerName",description:"æœåŠ¡å™¨åç§°",example:"alert-server-01"},{name:".System.Environment",description:"è¿è¡Œç¯å¢ƒ",example:"production"}],V=[{name:".Time.Now",description:"å½“å‰æ—¶é—´æˆ³",example:"1705314625"},{name:".Time.NowFormat",description:"å½“å‰æ—¶é—´ï¼ˆæ ¼å¼åŒ–ï¼‰",example:"2024-01-15 14:30:25"},{name:".Time.Today",description:"ä»Šå¤©æ—¥æœŸ",example:"2024-01-15"},{name:".Time.Year",description:"å½“å‰å¹´ä»½",example:"2024"},{name:".Time.Month",description:"å½“å‰æœˆä»½",example:"01"},{name:".Time.Day",description:"å½“å‰æ—¥æœŸ",example:"15"},{name:".Time.Hour",description:"å½“å‰å°æ—¶",example:"14"},{name:".Time.Minute",description:"å½“å‰åˆ†é’Ÿ",example:"30"},{name:".Time.Second",description:"å½“å‰ç§’æ•°",example:"25"},{name:".Time.Weekday",description:"æ˜ŸæœŸå‡ ",example:"æ˜ŸæœŸä¸€"}],l=[{name:"ç®€å•é‚®ä»¶é€šçŸ¥",description:"æœ€åŸºç¡€çš„é‚®ä»¶å‘Šè­¦é€šçŸ¥æ ¼å¼",template:`ä¸»é¢˜ï¼š{{.Email.Subject}}
å‘ä»¶äººï¼š{{.Email.Sender}}
æ—¶é—´ï¼š{{.Email.ReceivedAt}}

å…§å®¹ï¼š
{{.Email.Content}}

é€šçŸ¥æ—¶é—´ï¼š{{.Time.NowFormat}}`},{name:"è¯¦ç»†å‘Šè­¦ä¿¡æ¯",description:"åŒ…å«è§„åˆ™å’Œç³»ç»Ÿä¿¡æ¯çš„è¯¦ç»†å‘Šè­¦",template:`## ğŸš¨ {{.System.AppName}} å‘Šè­¦é€šçŸ¥

**å‘Šè­¦ä¿¡æ¯**
- ä¸»é¢˜ï¼š{{.Email.Subject}}
- å‘ä»¶äººï¼š{{.Email.Sender}}
- æ¥æ”¶æ—¶é—´ï¼š{{.Email.ReceivedAt}}

**åŒ¹é…è§„åˆ™**
- è§„åˆ™åç§°ï¼š{{.Rule.Name}}
- åŒ¹é…ç±»å‹ï¼š{{.Rule.MatchType}}
- ä¼˜å…ˆçº§ï¼š{{.Rule.Priority}}

**é‚®ä»¶å†…å®¹**
{{.Email.Content}}

---
*ç³»ç»Ÿï¼š{{.System.AppName}} | æœåŠ¡å™¨ï¼š{{.System.ServerName}} | é€šçŸ¥æ—¶é—´ï¼š{{.Time.NowFormat}}*`},{name:"HTMLé‚®ä»¶æ¨¡ç‰ˆ",description:"å¯Œæ–‡æœ¬æ ¼å¼çš„é‚®ä»¶é€šçŸ¥æ¨¡ç‰ˆ",template:`<h2 style="color: #e74c3c;">ğŸš¨ ç³»ç»Ÿå‘Šè­¦é€šçŸ¥</h2>

<table style="width: 100%; border-collapse: collapse;">
  <tr>
    <td style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;"><strong>é‚®ä»¶ä¸»é¢˜</strong></td>
    <td style="padding: 8px; border: 1px solid #ddd;">{{.Email.Subject}}</td>
  </tr>
  <tr>
    <td style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;"><strong>å‘ä»¶äºº</strong></td>
    <td style="padding: 8px; border: 1px solid #ddd;">{{.Email.Sender}}</td>
  </tr>
  <tr>
    <td style="padding: 8px; border: 1px solid #ddd; background-color: #f9f9f9;"><strong>æ¥æ”¶æ—¶é—´</strong></td>
    <td style="padding: 8px; border: 1px solid #ddd;">{{.Email.ReceivedAt}}</td>
  </tr>
</table>

<div style="background-color: #f8f9fa; padding: 15px; margin: 15px 0; border-left: 4px solid #007bff;">
  <h3>é‚®ä»¶å†…å®¹</h3>
  <p>{{.Email.Content}}</p>
</div>

<hr>
<p style="color: #6c757d; font-size: 12px;">
  é€šçŸ¥æ—¶é—´ï¼š{{.Time.NowFormat}} | ç³»ç»Ÿï¼š{{.System.AppName}} v{{.System.AppVersion}}
</p>`}],v=S=>{D("insert",S)};return(S,m)=>{const d=i("el-alert"),$=i("el-tab-pane"),W=i("el-button"),C=i("el-input"),P=i("el-tabs"),M=i("el-dialog");return x(),U(M,{modelValue:g.value,"onUpdate:modelValue":m[1]||(m[1]=E=>g.value=E),title:"æ¨¡ç‰ˆå˜é‡å¸®åŠ©",width:"70%","close-on-click-modal":!1},{default:t(()=>[a("div",Re,[a("div",Ue,[e(d,{title:"å˜é‡ä½¿ç”¨è¯´æ˜",type:"info","show-icon":"",closable:!1},{default:t(()=>m[2]||(m[2]=[a("p",null,[p("åœ¨æ¨¡ç‰ˆä¸­ä½¿ç”¨å˜é‡æ—¶ï¼Œè¯·ä½¿ç”¨åŒå¤§æ‹¬å·åŒ…å›´å˜é‡åï¼Œå¦‚ï¼š"),a("code",null,"{{.Email.Subject}}")],-1),a("p",null,"å˜é‡ååŒºåˆ†å¤§å°å†™ï¼Œè¯·æŒ‰ç…§ä¸‹é¢çš„æ ¼å¼å‡†ç¡®ä½¿ç”¨",-1)])),_:1})]),e(P,{modelValue:y.value,"onUpdate:modelValue":m[0]||(m[0]=E=>y.value=E),class:"variable-tabs"},{default:t(()=>[e($,{label:"é‚®ä»¶å˜é‡",name:"email"},{default:t(()=>[e(X,{title:"é‚®ä»¶ç›¸å…³å˜é‡",description:"ä»é‚®ä»¶ä¸­æå–çš„åŸºæœ¬ä¿¡æ¯",variables:f,onInsert:v})]),_:1}),e($,{label:"å‘Šè­¦å˜é‡",name:"alert"},{default:t(()=>[e(X,{title:"å‘Šè­¦ç›¸å…³å˜é‡",description:"å‘Šè­¦å¤„ç†è¿‡ç¨‹ä¸­ç”Ÿæˆçš„ä¿¡æ¯",variables:_,onInsert:v})]),_:1}),e($,{label:"è§„åˆ™å˜é‡",name:"rule"},{default:t(()=>[e(X,{title:"è§„åˆ™ç›¸å…³å˜é‡",description:"åŒ¹é…çš„å‘Šè­¦è§„åˆ™ä¿¡æ¯",variables:T,onInsert:v})]),_:1}),e($,{label:"é‚®ç®±å˜é‡",name:"mailbox"},{default:t(()=>[e(X,{title:"é‚®ç®±ç›¸å…³å˜é‡",description:"é‚®ç®±é…ç½®ä¿¡æ¯",variables:A,onInsert:v})]),_:1}),e($,{label:"ç³»ç»Ÿå˜é‡",name:"system"},{default:t(()=>[e(X,{title:"ç³»ç»Ÿç›¸å…³å˜é‡",description:"ç³»ç»Ÿç¯å¢ƒä¿¡æ¯",variables:O,onInsert:v})]),_:1}),e($,{label:"æ—¶é—´å˜é‡",name:"time"},{default:t(()=>[e(X,{title:"æ—¶é—´ç›¸å…³å˜é‡",description:"å„ç§æ—¶é—´æ ¼å¼",variables:V,onInsert:v})]),_:1}),e($,{label:"å¸¸ç”¨ç»„åˆ",name:"examples"},{default:t(()=>[a("div",Pe,[m[4]||(m[4]=a("h3",null,"å¸¸ç”¨å˜é‡ç»„åˆç¤ºä¾‹",-1)),a("div",Le,[(x(),R(oe,null,se(l,E=>a("div",{key:E.name,class:"example-item"},[a("div",Fe,[a("h4",null,h(E.name),1),e(W,{size:"small",type:"primary",onClick:G=>v(E.template)},{default:t(()=>m[3]||(m[3]=[p(" æ’å…¥æ¨¡ç‰ˆ ")])),_:2,__:[3]},1032,["onClick"])]),a("div",He,h(E.description),1),a("div",Be,[e(C,{"model-value":E.template,type:"textarea",rows:3,readonly:""},null,8,["model-value"])])])),64))])])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}}},Oe=ee(qe,[["__scopeId","data-v-ba3e621e"]]),We={class:"variable-selector"},Ye={class:"search-bar"},Je={class:"variable-tree"},Ke={class:"tree-node"},Ge={class:"node-label"},Qe={__name:"VariableSelector",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(b,{emit:j}){const u=b,D=j,g=Z({get:()=>u.modelValue,set:l=>D("update:modelValue",l)}),y=k(""),f=k(),_={children:"children",label:"label"},T=[{id:"email",label:"é‚®ä»¶å˜é‡",children:[{id:"email-subject",label:"é‚®ä»¶ä¸»é¢˜",variable:".Email.Subject"},{id:"email-sender",label:"å‘ä»¶äºº",variable:".Email.Sender"},{id:"email-content",label:"é‚®ä»¶å†…å®¹",variable:".Email.Content"},{id:"email-html-content",label:"HTMLå†…å®¹",variable:".Email.HTMLContent"},{id:"email-received-at",label:"æ¥æ”¶æ—¶é—´",variable:".Email.ReceivedAt"},{id:"email-size",label:"é‚®ä»¶å¤§å°",variable:".Email.Size"},{id:"email-message-id",label:"é‚®ä»¶ID",variable:".Email.MessageID"}]},{id:"alert",label:"å‘Šè­¦å˜é‡",children:[{id:"alert-id",label:"å‘Šè­¦ID",variable:".Alert.ID"},{id:"alert-subject",label:"å‘Šè­¦ä¸»é¢˜",variable:".Alert.Subject"},{id:"alert-status",label:"å‘Šè­¦çŠ¶æ€",variable:".Alert.Status"},{id:"alert-content",label:"å‘Šè­¦å†…å®¹",variable:".Alert.Content"},{id:"alert-created-at",label:"åˆ›å»ºæ—¶é—´",variable:".Alert.CreatedAt"},{id:"alert-received-at",label:"æ¥æ”¶æ—¶é—´",variable:".Alert.ReceivedAt"}]},{id:"rule",label:"è§„åˆ™å˜é‡",children:[{id:"rule-id",label:"è§„åˆ™ID",variable:".Rule.ID"},{id:"rule-name",label:"è§„åˆ™åç§°",variable:".Rule.Name"},{id:"rule-match-type",label:"åŒ¹é…ç±»å‹",variable:".Rule.MatchType"},{id:"rule-match-value",label:"åŒ¹é…å€¼",variable:".Rule.MatchValue"},{id:"rule-priority",label:"ä¼˜å…ˆçº§",variable:".Rule.Priority"},{id:"rule-description",label:"è§„åˆ™æè¿°",variable:".Rule.Description"}]},{id:"mailbox",label:"é‚®ç®±å˜é‡",children:[{id:"mailbox-id",label:"é‚®ç®±ID",variable:".Mailbox.ID"},{id:"mailbox-name",label:"é‚®ç®±åç§°",variable:".Mailbox.Name"},{id:"mailbox-email",label:"é‚®ç®±åœ°å€",variable:".Mailbox.Email"},{id:"mailbox-host",label:"IMAPä¸»æœº",variable:".Mailbox.Host"},{id:"mailbox-port",label:"IMAPç«¯å£",variable:".Mailbox.Port"}]},{id:"system",label:"ç³»ç»Ÿå˜é‡",children:[{id:"system-app-name",label:"åº”ç”¨åç§°",variable:".System.AppName"},{id:"system-app-version",label:"åº”ç”¨ç‰ˆæœ¬",variable:".System.AppVersion"},{id:"system-server-name",label:"æœåŠ¡å™¨åç§°",variable:".System.ServerName"},{id:"system-environment",label:"è¿è¡Œç¯å¢ƒ",variable:".System.Environment"}]},{id:"time",label:"æ—¶é—´å˜é‡",children:[{id:"time-now",label:"å½“å‰æ—¶é—´æˆ³",variable:".Time.Now"},{id:"time-now-format",label:"æ ¼å¼åŒ–æ—¶é—´",variable:".Time.NowFormat"},{id:"time-today",label:"ä»Šå¤©æ—¥æœŸ",variable:".Time.Today"},{id:"time-year",label:"å¹´ä»½",variable:".Time.Year"},{id:"time-month",label:"æœˆä»½",variable:".Time.Month"},{id:"time-day",label:"æ—¥æœŸ",variable:".Time.Day"},{id:"time-hour",label:"å°æ—¶",variable:".Time.Hour"},{id:"time-minute",label:"åˆ†é’Ÿ",variable:".Time.Minute"},{id:"time-second",label:"ç§’",variable:".Time.Second"},{id:"time-weekday",label:"æ˜ŸæœŸ",variable:".Time.Weekday"}]}],A=(l,v)=>l?v.label.includes(l)||v.variable&&v.variable.includes(l):!0,O=l=>{var v;(v=f.value)==null||v.filter(l)},V=l=>{D("select",l)};return(l,v)=>{const S=i("el-icon"),m=i("el-input"),d=i("el-button"),$=i("el-tree"),W=i("el-dialog");return x(),U(W,{modelValue:g.value,"onUpdate:modelValue":v[1]||(v[1]=C=>g.value=C),title:"é€‰æ‹©å˜é‡",width:"50%","close-on-click-modal":!1},{default:t(()=>[a("div",We,[a("div",Ye,[e(m,{modelValue:y.value,"onUpdate:modelValue":v[0]||(v[0]=C=>y.value=C),placeholder:"æœç´¢å˜é‡...",clearable:"",onInput:O},{prefix:t(()=>[e(S,null,{default:t(()=>[e(q(ve))]),_:1})]),_:1},8,["modelValue"])]),a("div",Je,[e($,{ref_key:"treeRef",ref:f,data:T,"node-key":"id",props:_,"filter-node-method":A,"expand-on-click-node":!1,"default-expand-all":""},{default:t(({data:C})=>[a("div",Ke,[a("span",Ge,h(C.label),1),C.variable?(x(),U(d,{key:0,size:"small",type:"primary",onClick:P=>V(C.variable)},{default:t(()=>v[2]||(v[2]=[p(" é€‰æ‹© ")])),_:2,__:[2]},1032,["onClick"])):K("",!0)])]),_:1},512)])])]),_:1},8,["modelValue"])}}},Xe=ee(Qe,[["__scopeId","data-v-9cda259d"]]),Ze={class:"template-form"},et={class:"code-editor"},tt={class:"editor-toolbar"},at={class:"preview-section"},lt={class:"preview-header"},nt={class:"preview-content subject-preview"},ot=["innerHTML"],st={class:"used-variables"},it={key:0,class:"no-variables"},rt={class:"dialog-footer"},dt={__name:"TemplateForm",props:{modelValue:{type:Boolean,default:!1},templateData:{type:Object,default:null}},emits:["update:modelValue","success"],setup(b,{emit:j}){const u=b,D=j,g=k(!1),y=k(),f=k(!1),_=k(!1),T=k(!1),A=k(!1),O=k("content"),V=Z(()=>{var o;return!!((o=u.templateData)!=null&&o.id)}),l=ue({name:"",type:"email",subject:"",content:"",is_default:!1,description:""}),v={name:[{required:!0,message:"è¯·è¾“å…¥æ¨¡ç‰ˆåç§°",trigger:"blur"},{min:2,max:50,message:"æ¨¡ç‰ˆåç§°é•¿åº¦åœ¨ 2 åˆ° 50 ä¸ªå­—ç¬¦",trigger:"blur"}],type:[{required:!0,message:"è¯·é€‰æ‹©æ¨¡ç‰ˆç±»å‹",trigger:"change"}],content:[{required:!0,message:"è¯·è¾“å…¥æ¨¡ç‰ˆå†…å®¹",trigger:"blur"},{min:10,message:"æ¨¡ç‰ˆå†…å®¹è‡³å°‘éœ€è¦ 10 ä¸ªå­—ç¬¦",trigger:"blur"}]},S=k({subject:"",content:"",used_vars:[]});le(()=>u.modelValue,o=>{g.value=o,o&&(m(),ge(()=>{M()}))}),le(g,o=>{D("update:modelValue",o)});const m=()=>{u.templateData?Object.assign(l,{name:u.templateData.name||"",type:u.templateData.type||"email",subject:u.templateData.subject||"",content:u.templateData.content||"",is_default:u.templateData.is_default||!1,description:u.templateData.description||""}):Object.assign(l,{name:"",type:"email",subject:"",content:"",is_default:!1,description:""})},d=o=>{if(o==="email"&&!l.subject&&(l.subject="ã€å‘Šè­¦ã€‘{{.System.AppName}} - {{.Email.Subject}}"),!l.content)switch(o){case"email":l.content=$();break;case"dingtalk":l.content=W();break;case"wechat":l.content=C();break;case"markdown":l.content=P();break}M()},$=()=>`<h2>ğŸš¨ ç³»ç»Ÿå‘Šè­¦é€šçŸ¥</h2>
<p><strong>é‚®ä»¶ä¸»é¢˜ï¼š</strong>{{.Email.Subject}}</p>
<p><strong>å‘ä»¶äººï¼š</strong>{{.Email.Sender}}</p>
<p><strong>æ¥æ”¶æ—¶é—´ï¼š</strong>{{.Email.ReceivedAt}}</p>
<div style="background-color: #f8f9fa; padding: 10px; margin: 10px 0;">
  <h3>é‚®ä»¶å†…å®¹</h3>
  <div>{{.Email.Content}}</div>
</div>
<p><small>é€šçŸ¥æ—¶é—´ï¼š{{.Time.NowFormat}} | ç³»ç»Ÿï¼š{{.System.AppName}}</small></p>`,W=()=>`## ğŸš¨ ç³»ç»Ÿå‘Šè­¦é€šçŸ¥

**å‘Šè­¦è¯¦æƒ…**
- **é‚®ä»¶ä¸»é¢˜ï¼š** {{.Email.Subject}}
- **å‘ä»¶äººï¼š** {{.Email.Sender}}
- **æ¥æ”¶æ—¶é—´ï¼š** {{.Email.ReceivedAt}}

**é‚®ä»¶å†…å®¹**
> {{.Email.Content}}

**ç³»ç»Ÿä¿¡æ¯**
- **é€šçŸ¥æ—¶é—´ï¼š** {{.Time.NowFormat}}
- **ç³»ç»Ÿï¼š** {{.System.AppName}}`,C=()=>`ã€ç³»ç»Ÿå‘Šè­¦é€šçŸ¥ã€‘

é‚®ä»¶ä¸»é¢˜ï¼š{{.Email.Subject}}
å‘ä»¶äººï¼š{{.Email.Sender}}
æ¥æ”¶æ—¶é—´ï¼š{{.Email.ReceivedAt}}

é‚®ä»¶å†…å®¹ï¼š
{{.Email.Content}}

é€šçŸ¥æ—¶é—´ï¼š{{.Time.NowFormat}}
ç³»ç»Ÿï¼š{{.System.AppName}}`,P=()=>`# ğŸš¨ ç³»ç»Ÿå‘Šè­¦é€šçŸ¥

| é¡¹ç›® | å†…å®¹ |
|------|------|
| é‚®ä»¶ä¸»é¢˜ | {{.Email.Subject}} |
| å‘ä»¶äºº | {{.Email.Sender}} |
| æ¥æ”¶æ—¶é—´ | {{.Email.ReceivedAt}} |

## é‚®ä»¶å†…å®¹

\`\`\`
{{.Email.Content}}
\`\`\`

---
*é€šçŸ¥æ—¶é—´ï¼š{{.Time.NowFormat}} | ç³»ç»Ÿï¼š{{.System.AppName}}*`,M=async()=>{if(l.content){_.value=!0;try{const o=await J.preview({content:l.content,subject:l.subject});S.value=o.data}catch(o){console.error("é¢„è§ˆå¤±è´¥:",o),z.error("é¢„è§ˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥æ¨¡ç‰ˆè¯­æ³•")}finally{_.value=!1}}},E=Z(()=>{if(!S.value.content)return"å†…å®¹é¢„è§ˆ...";const o=S.value.content;switch(l.type){case"email":return o;case"dingtalk":case"markdown":return o.replace(/^## (.*$)/gm,"<h2>$1</h2>").replace(/^# (.*$)/gm,"<h1>$1</h1>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^- (.*$)/gm,"<li>$1</li>").replace(/\n/g,"<br>");case"wechat":default:return o.replace(/\n/g,"<br>")}}),G=()=>{A.value=!0},r=o=>{l.content+=`{{${o}}}`,M()},n=o=>{r(o),A.value=!1},N=()=>{l.type==="email"&&(l.content=l.content.replace(/></g,`>
<`).replace(/^\s+/gm,"")),M()},Y=async()=>{try{await y.value.validate(),f.value=!0;const o={name:l.name,type:l.type,subject:l.subject,content:l.content,is_default:l.is_default,description:l.description};V.value?(await J.update(u.templateData.id,o),z.success("æ¨¡ç‰ˆæ›´æ–°æˆåŠŸ")):(await J.create(o),z.success("æ¨¡ç‰ˆåˆ›å»ºæˆåŠŸ")),D("success"),g.value=!1}catch(o){console.error("æäº¤å¤±è´¥:",o)}finally{f.value=!1}},Q=()=>{var o;(o=y.value)==null||o.resetFields(),S.value={subject:"",content:"",used_vars:[]}};return le([()=>l.content,()=>l.subject],()=>{if(l.content){const o=setTimeout(()=>{M()},500);return()=>clearTimeout(o)}},{deep:!0}),(o,s)=>{const I=i("el-input"),L=i("el-form-item"),F=i("el-option"),H=i("el-select"),B=i("el-button"),ie=i("el-button-group"),re=i("el-switch"),de=i("el-form"),ne=i("el-col"),te=i("el-tab-pane"),me=i("el-tag"),ce=i("el-tabs"),c=i("el-row"),ae=i("el-dialog");return x(),U(ae,{modelValue:g.value,"onUpdate:modelValue":s[11]||(s[11]=w=>g.value=w),title:V.value?"ç¼–è¾‘æ¨¡ç‰ˆ":"æ·»åŠ æ¨¡ç‰ˆ",width:"90%","close-on-click-modal":!1,onClosed:Q},{footer:t(()=>[a("div",rt,[e(B,{onClick:s[8]||(s[8]=w=>g.value=!1)},{default:t(()=>s[17]||(s[17]=[p("å–æ¶ˆ")])),_:1,__:[17]}),e(B,{type:"primary",onClick:Y,loading:f.value},{default:t(()=>[p(h(V.value?"æ›´æ–°":"åˆ›å»º"),1)]),_:1},8,["loading"])])]),default:t(()=>[a("div",Ze,[e(c,{gutter:20},{default:t(()=>[e(ne,{span:12},{default:t(()=>[e(de,{ref_key:"formRef",ref:y,model:l,rules:v,"label-width":"80px"},{default:t(()=>[e(L,{label:"æ¨¡ç‰ˆåç§°",prop:"name"},{default:t(()=>[e(I,{modelValue:l.name,"onUpdate:modelValue":s[0]||(s[0]=w=>l.name=w),placeholder:"è¯·è¾“å…¥æ¨¡ç‰ˆåç§°",clearable:""},null,8,["modelValue"])]),_:1}),e(L,{label:"æ¨¡ç‰ˆç±»å‹",prop:"type"},{default:t(()=>[e(H,{modelValue:l.type,"onUpdate:modelValue":s[1]||(s[1]=w=>l.type=w),placeholder:"è¯·é€‰æ‹©æ¨¡ç‰ˆç±»å‹",style:{width:"100%"},onChange:d},{default:t(()=>[e(F,{label:"é‚®ä»¶æ¨¡ç‰ˆ",value:"email"}),e(F,{label:"é’‰é’‰æ¨¡ç‰ˆ",value:"dingtalk"}),e(F,{label:"ä¼ä¸šå¾®ä¿¡",value:"wechat"}),e(F,{label:"Markdown",value:"markdown"})]),_:1},8,["modelValue"])]),_:1}),l.type==="email"?(x(),U(L,{key:0,label:"é‚®ä»¶ä¸»é¢˜",prop:"subject"},{default:t(()=>[e(I,{modelValue:l.subject,"onUpdate:modelValue":s[2]||(s[2]=w=>l.subject=w),placeholder:"æ”¯æŒå˜é‡ï¼Œå¦‚ï¼šã€å‘Šè­¦ã€‘{{.System.AppName}} - {{.Email.Subject}}",clearable:""},null,8,["modelValue"])]),_:1})):K("",!0),e(L,{label:"æ¨¡ç‰ˆå†…å®¹",prop:"content"},{default:t(()=>[a("div",et,[a("div",tt,[e(ie,null,{default:t(()=>[e(B,{size:"small",onClick:G,icon:q(be)},{default:t(()=>s[12]||(s[12]=[p(" æ’å…¥å˜é‡ ")])),_:1,__:[12]},8,["icon"]),e(B,{size:"small",onClick:s[3]||(s[3]=w=>T.value=!0),icon:q(fe)},{default:t(()=>s[13]||(s[13]=[p(" å˜é‡å¸®åŠ© ")])),_:1,__:[13]},8,["icon"]),e(B,{size:"small",onClick:N,icon:q(ye)},{default:t(()=>s[14]||(s[14]=[p(" æ ¼å¼åŒ– ")])),_:1,__:[14]},8,["icon"])]),_:1})]),e(I,{modelValue:l.content,"onUpdate:modelValue":s[4]||(s[4]=w=>l.content=w),type:"textarea",rows:12,placeholder:"è¯·è¾“å…¥æ¨¡ç‰ˆå†…å®¹ï¼Œæ”¯æŒå˜é‡æ›¿æ¢ï¼Œå¦‚ï¼š{{.Email.Subject}}",style:{"font-family":"'Monaco', 'Menlo', 'Ubuntu Mono', monospace"}},null,8,["modelValue"])])]),_:1}),e(L,{label:"æ˜¯å¦é»˜è®¤"},{default:t(()=>[e(re,{modelValue:l.is_default,"onUpdate:modelValue":s[5]||(s[5]=w=>l.is_default=w),"active-text":"è®¾ä¸ºé»˜è®¤æ¨¡ç‰ˆ","inactive-text":"æ™®é€šæ¨¡ç‰ˆ"},null,8,["modelValue"])]),_:1}),e(L,{label:"æè¿°"},{default:t(()=>[e(I,{modelValue:l.description,"onUpdate:modelValue":s[6]||(s[6]=w=>l.description=w),type:"textarea",rows:3,placeholder:"è¯·è¾“å…¥æ¨¡ç‰ˆæè¿°"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),e(ne,{span:12},{default:t(()=>[a("div",at,[a("div",lt,[s[16]||(s[16]=a("span",null,"å®æ—¶é¢„è§ˆ",-1)),e(B,{size:"small",type:"primary",onClick:M,loading:_.value},{default:t(()=>s[15]||(s[15]=[p(" åˆ·æ–°é¢„è§ˆ ")])),_:1,__:[15]},8,["loading"])]),e(ce,{modelValue:O.value,"onUpdate:modelValue":s[7]||(s[7]=w=>O.value=w),class:"preview-tabs"},{default:t(()=>[l.type==="email"&&l.subject?(x(),U(te,{key:0,label:"é‚®ä»¶ä¸»é¢˜",name:"subject"},{default:t(()=>[a("div",nt,h(S.value.subject||"ä¸»é¢˜é¢„è§ˆ..."),1)]),_:1})):K("",!0),e(te,{label:"å†…å®¹é¢„è§ˆ",name:"content"},{default:t(()=>[a("div",{class:pe(["preview-content",{"html-preview":l.type==="email","markdown-preview":l.type==="dingtalk"||l.type==="markdown","text-preview":l.type==="wechat"}]),innerHTML:E.value},null,10,ot)]),_:1}),e(te,{label:"ä½¿ç”¨å˜é‡",name:"variables"},{default:t(()=>[a("div",st,[(x(!0),R(oe,null,se(S.value.used_vars,w=>(x(),U(me,{key:w,size:"small",class:"variable-tag"},{default:t(()=>[p(h(w),1)]),_:2},1024))),128)),!S.value.used_vars||S.value.used_vars.length===0?(x(),R("div",it," æš‚æœªä½¿ç”¨ä»»ä½•å˜é‡ ")):K("",!0)])]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),e(Oe,{modelValue:T.value,"onUpdate:modelValue":s[9]||(s[9]=w=>T.value=w),onInsert:r},null,8,["modelValue"]),e(Xe,{modelValue:A.value,"onUpdate:modelValue":s[10]||(s[10]=w=>A.value=w),onSelect:n},null,8,["modelValue"])]),_:1},8,["modelValue","title"])}}},mt=ee(dt,[["__scopeId","data-v-0786f781"]]),ct={class:"template-preview"},ut={class:"preview-header"},pt={class:"template-info"},vt={class:"template-meta"},bt={class:"meta-text"},_t={class:"preview-actions"},ft={class:"preview-content"},yt={key:0,class:"subject-section"},gt={class:"subject-preview"},wt={class:"content-section"},xt=["innerHTML"],ht={class:"template-source"},Vt={key:0,class:"subject-source"},St={class:"content-source"},kt={class:"variables-section"},Dt={key:0,class:"variable-list"},Tt={key:1,class:"no-variables"},$t={class:"sample-data"},Ct={class:"dialog-footer"},Et={__name:"TemplatePreview",props:{modelValue:{type:Boolean,default:!1},templateData:{type:Object,default:null}},emits:["update:modelValue","edit"],setup(b,{emit:j}){const u=b,D=j,g=Z({get:()=>u.modelValue,set:m=>D("update:modelValue",m)}),y=k(!1),f=k("preview"),_=k({subject:"",content:"",used_vars:[]}),T={Email:{Subject:"ã€å‘Šè­¦ã€‘ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“è¿æ¥å¼‚å¸¸",Sender:"monitor@example.com",Content:"ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“è¿æ¥å‡ºç°å¼‚å¸¸ï¼Œè¿æ¥è¶…æ—¶ã€‚è¯·ç«‹å³æ£€æŸ¥æ•°æ®åº“æœåŠ¡å™¨çŠ¶æ€ã€‚é”™è¯¯ä¿¡æ¯ï¼šConnection timeout after 30 seconds",HTMLContent:"<p>ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“è¿æ¥å‡ºç°å¼‚å¸¸ï¼Œè¿æ¥è¶…æ—¶ã€‚</p><p>è¯·ç«‹å³æ£€æŸ¥æ•°æ®åº“æœåŠ¡å™¨çŠ¶æ€ã€‚</p><p><strong>é”™è¯¯ä¿¡æ¯ï¼š</strong>Connection timeout after 30 seconds</p>",ReceivedAt:"2024-01-15 14:30:25",Size:1024,MessageID:"<123456789@example.com>"},Alert:{ID:1001,Subject:"ã€å‘Šè­¦ã€‘ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“è¿æ¥å¼‚å¸¸",Status:"active",Content:"ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“è¿æ¥å‡ºç°å¼‚å¸¸ï¼Œè¿æ¥è¶…æ—¶ã€‚è¯·ç«‹å³æ£€æŸ¥æ•°æ®åº“æœåŠ¡å™¨çŠ¶æ€ã€‚",CreatedAt:"2024-01-15 14:30:25",ReceivedAt:"2024-01-15 14:30:25"},Rule:{ID:1,Name:"ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“å‘Šè­¦",MatchType:"keyword",MatchValue:"æ•°æ®åº“,è¿æ¥,å¼‚å¸¸,è¶…æ—¶",Priority:9,Description:"ç”¨äºç›‘æ§ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“ç›¸å…³å‘Šè­¦"},Mailbox:{ID:1,Name:"ç”Ÿäº§ç¯å¢ƒç›‘æ§é‚®ç®±",Email:"monitor@example.com",Host:"imap.example.com",Port:993},System:{AppName:"ç»Ÿä¸€é‚®ä»¶å‘Šè­¦å¹³å°",AppVersion:"v1.0.0",ServerName:"alert-server-01",Environment:"production"},Time:{Now:Math.floor(Date.now()/1e3),NowFormat:new Date().toLocaleString("zh-CN"),Today:new Date().toLocaleDateString("zh-CN"),Year:new Date().getFullYear(),Month:String(new Date().getMonth()+1).padStart(2,"0"),Day:String(new Date().getDate()).padStart(2,"0"),Hour:String(new Date().getHours()).padStart(2,"0"),Minute:String(new Date().getMinutes()).padStart(2,"0"),Second:String(new Date().getSeconds()).padStart(2,"0"),Weekday:["æ˜ŸæœŸæ—¥","æ˜ŸæœŸä¸€","æ˜ŸæœŸäºŒ","æ˜ŸæœŸä¸‰","æ˜ŸæœŸå››","æ˜ŸæœŸäº”","æ˜ŸæœŸå…­"][new Date().getDay()]}},A=m=>({email:"primary",dingtalk:"success",wechat:"warning",markdown:"info"})[m]||"info",O=m=>({email:"é‚®ä»¶æ¨¡ç‰ˆ",dingtalk:"é’‰é’‰æ¨¡ç‰ˆ",wechat:"ä¼ä¸šå¾®ä¿¡æ¨¡ç‰ˆ",markdown:"Markdownæ¨¡ç‰ˆ"})[m]||m,V=m=>m?new Date(m).toLocaleString("zh-CN"):"-",l=Z(()=>{var d;if(!_.value.content)return"åŠ è½½ä¸­...";const m=_.value.content;switch((d=u.templateData)==null?void 0:d.type){case"email":return m;case"dingtalk":case"markdown":return m.replace(/^### (.*$)/gm,"<h3>$1</h3>").replace(/^## (.*$)/gm,"<h2>$1</h2>").replace(/^# (.*$)/gm,"<h1>$1</h1>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^- (.*$)/gm,"<li>$1</li>").replace(/^> (.*$)/gm,"<blockquote>$1</blockquote>").replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\n/g,"<br>");case"wechat":default:return m.replace(/\n/g,"<br>")}}),v=async()=>{var m;if((m=u.templateData)!=null&&m.content){y.value=!0;try{const d=await J.preview({content:u.templateData.content,subject:u.templateData.subject||""});_.value=d.data}catch(d){console.error("é¢„è§ˆå¤±è´¥:",d),z.error("é¢„è§ˆå¤±è´¥ï¼Œè¯·æ£€æŸ¥æ¨¡ç‰ˆè¯­æ³•")}finally{y.value=!1}}},S=()=>{D("edit",u.templateData),g.value=!1};return le(()=>u.templateData,m=>{m&&g.value&&v()},{immediate:!0}),le(g,m=>{m&&u.templateData&&(f.value="preview",v())}),(m,d)=>{const $=i("el-tag"),W=i("el-icon"),C=i("el-button"),P=i("el-tab-pane"),M=i("el-input"),E=i("el-empty"),G=i("el-tabs"),r=i("el-dialog");return x(),U(r,{modelValue:g.value,"onUpdate:modelValue":d[2]||(d[2]=n=>g.value=n),title:"æ¨¡ç‰ˆé¢„è§ˆ",width:"80%","close-on-click-modal":!1},{footer:t(()=>[a("div",Ct,[e(C,{onClick:d[1]||(d[1]=n=>g.value=!1)},{default:t(()=>d[11]||(d[11]=[p("å…³é—­")])),_:1,__:[11]}),e(C,{type:"primary",onClick:S},{default:t(()=>[e(W,null,{default:t(()=>[e(q(_e))]),_:1}),d[12]||(d[12]=p(" ç¼–è¾‘æ¨¡ç‰ˆ "))]),_:1,__:[12]})])]),default:t(()=>{var n,N,Y,Q;return[a("div",ct,[a("div",ut,[a("div",pt,[a("h3",null,h((n=b.templateData)==null?void 0:n.name),1),a("div",vt,[e($,{type:A((N=b.templateData)==null?void 0:N.type),size:"small"},{default:t(()=>{var o;return[p(h(O((o=b.templateData)==null?void 0:o.type)),1)]}),_:1},8,["type"]),(Y=b.templateData)!=null&&Y.is_default?(x(),U($,{key:0,type:"success",size:"small"},{default:t(()=>d[3]||(d[3]=[p("é»˜è®¤æ¨¡ç‰ˆ")])),_:1,__:[3]})):K("",!0),a("span",bt,"æ›´æ–°æ—¶é—´ï¼š"+h(V((Q=b.templateData)==null?void 0:Q.updated_at)),1)])]),a("div",_t,[e(C,{onClick:v,loading:y.value},{default:t(()=>[e(W,null,{default:t(()=>[e(q(we))]),_:1}),d[4]||(d[4]=p(" åˆ·æ–°é¢„è§ˆ "))]),_:1,__:[4]},8,["loading"])])]),e(G,{modelValue:f.value,"onUpdate:modelValue":d[0]||(d[0]=o=>f.value=o),class:"preview-tabs"},{default:t(()=>[e(P,{label:"é¢„è§ˆæ•ˆæœ",name:"preview"},{default:t(()=>{var o,s,I,L,F,H;return[a("div",ft,[((o=b.templateData)==null?void 0:o.type)==="email"&&((s=b.templateData)!=null&&s.subject)?(x(),R("div",yt,[d[5]||(d[5]=a("h4",null,"é‚®ä»¶ä¸»é¢˜",-1)),a("div",gt,h(_.value.subject||b.templateData.subject),1)])):K("",!0),a("div",wt,[d[6]||(d[6]=a("h4",null,"å†…å®¹é¢„è§ˆ",-1)),a("div",{class:pe(["content-preview",{"html-preview":((I=b.templateData)==null?void 0:I.type)==="email","markdown-preview":((L=b.templateData)==null?void 0:L.type)==="dingtalk"||((F=b.templateData)==null?void 0:F.type)==="markdown","text-preview":((H=b.templateData)==null?void 0:H.type)==="wechat"}]),innerHTML:l.value},null,10,xt)])])]}),_:1}),e(P,{label:"åŸå§‹æ¨¡ç‰ˆ",name:"template"},{default:t(()=>{var o,s,I;return[a("div",ht,[((o=b.templateData)==null?void 0:o.type)==="email"&&((s=b.templateData)!=null&&s.subject)?(x(),R("div",Vt,[d[7]||(d[7]=a("h4",null,"é‚®ä»¶ä¸»é¢˜æ¨¡ç‰ˆ",-1)),e(M,{"model-value":b.templateData.subject,type:"textarea",rows:2,readonly:"",class:"template-textarea"},null,8,["model-value"])])):K("",!0),a("div",St,[d[8]||(d[8]=a("h4",null,"å†…å®¹æ¨¡ç‰ˆ",-1)),e(M,{"model-value":((I=b.templateData)==null?void 0:I.content)||"",type:"textarea",rows:15,readonly:"",class:"template-textarea"},null,8,["model-value"])])])]}),_:1}),e(P,{label:"ä½¿ç”¨å˜é‡",name:"variables"},{default:t(()=>[a("div",kt,[d[9]||(d[9]=a("h4",null,"æ¨¡ç‰ˆä¸­ä½¿ç”¨çš„å˜é‡",-1)),_.value.used_vars&&_.value.used_vars.length>0?(x(),R("div",Dt,[(x(!0),R(oe,null,se(_.value.used_vars,o=>(x(),U($,{key:o,size:"medium",class:"variable-tag"},{default:t(()=>[p(h(o),1)]),_:2},1024))),128))])):(x(),R("div",Tt,[e(E,{description:"è¯¥æ¨¡ç‰ˆæš‚æœªä½¿ç”¨ä»»ä½•å˜é‡"})]))])]),_:1}),e(P,{label:"ç¤ºä¾‹æ•°æ®",name:"data"},{default:t(()=>[a("div",$t,[d[10]||(d[10]=a("h4",null,"é¢„è§ˆä½¿ç”¨çš„ç¤ºä¾‹æ•°æ®",-1)),e(M,{"model-value":JSON.stringify(T,null,2),type:"textarea",rows:20,readonly:"",class:"json-textarea"},null,8,["model-value"])])]),_:1})]),_:1},8,["modelValue"])])]}),_:1},8,["modelValue"])}}},Mt=ee(Et,[["__scopeId","data-v-f94d74a4"]]),jt={class:"templates-page"},At={class:"page-header"},Nt={class:"header-right"},It={class:"filter-section"},zt={class:"table-section"},Rt={class:"template-name"},Ut={class:"pagination-section"},Pt={__name:"Templates",setup(b){const j=k(!1),u=k(!1),D=k(!1),g=k([]),y=k(null),f=ue({name:"",type:"",status:""}),_=ue({page:1,size:20,total:0}),T=r=>({email:"primary",dingtalk:"success",wechat:"warning",markdown:"info"})[r]||"info",A=r=>({email:"é‚®ä»¶",dingtalk:"é’‰é’‰",wechat:"å¾®ä¿¡",markdown:"MD"})[r]||r,O=r=>r?new Date(r).toLocaleString("zh-CN"):"-",V=async()=>{j.value=!0;try{const r={page:_.page,size:_.size,...f};Object.keys(r).forEach(N=>{(r[N]===""||r[N]===null||r[N]===void 0)&&delete r[N]});const n=await J.list(r);g.value=n.data.list||[],_.total=n.data.total||0}catch(r){console.error("åŠ è½½æ¨¡ç‰ˆåˆ—è¡¨å¤±è´¥:",r),z.error("åŠ è½½æ¨¡ç‰ˆåˆ—è¡¨å¤±è´¥")}finally{j.value=!1}},l=()=>{_.page=1,V()},v=()=>{Object.assign(f,{name:"",type:"",status:""}),l()},S=()=>{y.value=null,u.value=!0},m=r=>{y.value={...r},u.value=!0},d=r=>{y.value=r,D.value=!0},$=async(r,n)=>{switch(r){case"setDefault":await W(n);break;case"duplicate":await C(n);break;case"toggleStatus":await P(n);break;case"delete":await M(n);break}},W=async r=>{try{await J.setDefault(r.id),z.success("è®¾ç½®é»˜è®¤æ¨¡ç‰ˆæˆåŠŸ"),V()}catch(n){console.error("è®¾ç½®é»˜è®¤æ¨¡ç‰ˆå¤±è´¥:",n),z.error("è®¾ç½®é»˜è®¤æ¨¡ç‰ˆå¤±è´¥")}},C=async r=>{try{const n={name:`${r.name} - å‰¯æœ¬`,type:r.type,subject:r.subject,content:r.content,description:`${r.description||""} (å¤åˆ¶è‡ª ${r.name})`,is_default:!1,status:"active"};await J.create(n),z.success("å¤åˆ¶æ¨¡ç‰ˆæˆåŠŸ"),V()}catch(n){console.error("å¤åˆ¶æ¨¡ç‰ˆå¤±è´¥:",n),z.error("å¤åˆ¶æ¨¡ç‰ˆå¤±è´¥")}},P=async r=>{try{const n=r.status==="active"?"inactive":"active";await J.update(r.id,{status:n}),z.success(`æ¨¡ç‰ˆå·²${n==="active"?"å¯ç”¨":"åœç”¨"}`),V()}catch(n){console.error("åˆ‡æ¢çŠ¶æ€å¤±è´¥:",n),z.error("åˆ‡æ¢çŠ¶æ€å¤±è´¥")}},M=async r=>{try{await De.confirm(`ç¡®å®šè¦åˆ é™¤æ¨¡ç‰ˆ"${r.name}"å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚`,"ç¡®è®¤åˆ é™¤",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await J.delete(r.id),z.success("åˆ é™¤æ¨¡ç‰ˆæˆåŠŸ"),V()}catch(n){n!=="cancel"&&(console.error("åˆ é™¤æ¨¡ç‰ˆå¤±è´¥:",n),z.error("åˆ é™¤æ¨¡ç‰ˆå¤±è´¥"))}},E=()=>{V()},G=r=>{y.value={...r},D.value=!1,u.value=!0};return xe(()=>{V()}),(r,n)=>{const N=i("el-icon"),Y=i("el-button"),Q=i("el-input"),o=i("el-col"),s=i("el-option"),I=i("el-select"),L=i("el-row"),F=i("el-tag"),H=i("el-table-column"),B=i("el-dropdown-item"),ie=i("el-dropdown-menu"),re=i("el-dropdown"),de=i("el-button-group"),ne=i("el-table"),te=i("el-pagination"),me=i("el-card"),ce=he("loading");return x(),R("div",jt,[e(me,null,{header:t(()=>[a("div",At,[n[8]||(n[8]=a("div",{class:"header-left"},[a("h2",null,"æ¶ˆæ¯æ¨¡ç‰ˆç®¡ç†"),a("p",{class:"page-description"},"ç®¡ç†å‘Šè­¦æ¶ˆæ¯çš„è¾“å‡ºæ¨¡ç‰ˆï¼Œæ”¯æŒå¤šç§æ ¼å¼å’Œå˜é‡æ›¿æ¢")],-1)),a("div",Nt,[e(Y,{type:"primary",onClick:S},{default:t(()=>[e(N,null,{default:t(()=>[e(q(be))]),_:1}),n[7]||(n[7]=p(" æ·»åŠ æ¨¡ç‰ˆ "))]),_:1,__:[7]})])])]),default:t(()=>[a("div",It,[e(L,{gutter:16},{default:t(()=>[e(o,{span:8},{default:t(()=>[e(Q,{modelValue:f.name,"onUpdate:modelValue":n[0]||(n[0]=c=>f.name=c),placeholder:"æœç´¢æ¨¡ç‰ˆåç§°...",clearable:"",onInput:l},{prefix:t(()=>[e(N,null,{default:t(()=>[e(q(ve))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(o,{span:6},{default:t(()=>[e(I,{modelValue:f.type,"onUpdate:modelValue":n[1]||(n[1]=c=>f.type=c),placeholder:"æ¨¡ç‰ˆç±»å‹",clearable:"",onChange:l},{default:t(()=>[e(s,{label:"å…¨éƒ¨ç±»å‹",value:""}),e(s,{label:"é‚®ä»¶æ¨¡ç‰ˆ",value:"email"}),e(s,{label:"é’‰é’‰æ¨¡ç‰ˆ",value:"dingtalk"}),e(s,{label:"ä¼ä¸šå¾®ä¿¡",value:"wechat"}),e(s,{label:"Markdown",value:"markdown"})]),_:1},8,["modelValue"])]),_:1}),e(o,{span:6},{default:t(()=>[e(I,{modelValue:f.status,"onUpdate:modelValue":n[2]||(n[2]=c=>f.status=c),placeholder:"çŠ¶æ€",clearable:"",onChange:l},{default:t(()=>[e(s,{label:"å…¨éƒ¨çŠ¶æ€",value:""}),e(s,{label:"æ´»è·ƒ",value:"active"}),e(s,{label:"åœç”¨",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(o,{span:4},{default:t(()=>[e(Y,{onClick:v},{default:t(()=>n[9]||(n[9]=[p("é‡ç½®")])),_:1,__:[9]})]),_:1})]),_:1})]),a("div",zt,[Ve((x(),U(ne,{data:g.value,stripe:"",style:{width:"100%"}},{default:t(()=>[e(H,{prop:"name",label:"æ¨¡ç‰ˆåç§°","min-width":"150"},{default:t(c=>[a("div",Rt,[a("span",null,h(c.row.name),1),c.row.is_default?(x(),U(F,{key:0,type:"success",size:"small"},{default:t(()=>n[10]||(n[10]=[p("é»˜è®¤")])),_:1,__:[10]})):K("",!0)])]),_:1}),e(H,{prop:"type",label:"æ¨¡ç‰ˆç±»å‹",width:"120"},{default:t(c=>[e(F,{type:T(c.row.type),size:"small"},{default:t(()=>[p(h(A(c.row.type)),1)]),_:2},1032,["type"])]),_:1}),e(H,{prop:"description",label:"æè¿°","min-width":"200","show-overflow-tooltip":""}),e(H,{prop:"status",label:"çŠ¶æ€",width:"80"},{default:t(c=>[e(F,{type:c.row.status==="active"?"success":"info",size:"small"},{default:t(()=>[p(h(c.row.status==="active"?"æ´»è·ƒ":"åœç”¨"),1)]),_:2},1032,["type"])]),_:1}),e(H,{prop:"updated_at",label:"æ›´æ–°æ—¶é—´",width:"180"},{default:t(c=>[p(h(O(c.row.updated_at)),1)]),_:1}),e(H,{label:"æ“ä½œ",width:"250",fixed:"right"},{default:t(c=>[e(de,null,{default:t(()=>[e(Y,{type:"primary",size:"small",onClick:ae=>d(c.row),icon:q(Se)},{default:t(()=>n[11]||(n[11]=[p(" é¢„è§ˆ ")])),_:2,__:[11]},1032,["onClick","icon"]),e(Y,{type:"success",size:"small",onClick:ae=>m(c.row),icon:q(_e)},{default:t(()=>n[12]||(n[12]=[p(" ç¼–è¾‘ ")])),_:2,__:[12]},1032,["onClick","icon"]),e(re,{onCommand:ae=>$(ae,c.row)},{dropdown:t(()=>[e(ie,null,{default:t(()=>[e(B,{command:"setDefault",disabled:c.row.is_default},{default:t(()=>n[14]||(n[14]=[p(" è®¾ä¸ºé»˜è®¤ ")])),_:2,__:[14]},1032,["disabled"]),e(B,{command:"duplicate"},{default:t(()=>n[15]||(n[15]=[p(" å¤åˆ¶æ¨¡ç‰ˆ ")])),_:1,__:[15]}),e(B,{command:"toggleStatus",class:pe(c.row.status==="active"?"text-warning":"text-success")},{default:t(()=>[p(h(c.row.status==="active"?"åœç”¨":"å¯ç”¨"),1)]),_:2},1032,["class"]),e(B,{command:"delete",class:"text-danger",divided:""},{default:t(()=>n[16]||(n[16]=[p(" åˆ é™¤ ")])),_:1,__:[16]})]),_:2},1024)]),default:t(()=>[e(Y,{size:"small",type:"info"},{default:t(()=>[n[13]||(n[13]=p(" æ›´å¤š")),e(N,{class:"el-icon--right"},{default:t(()=>[e(q(ke))]),_:1})]),_:1,__:[13]})]),_:2},1032,["onCommand"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ce,j.value]]),a("div",Ut,[e(te,{"current-page":_.page,"onUpdate:currentPage":n[3]||(n[3]=c=>_.page=c),"page-size":_.size,"onUpdate:pageSize":n[4]||(n[4]=c=>_.size=c),"page-sizes":[10,20,50,100],total:_.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:V,onCurrentChange:V},null,8,["current-page","page-size","total"])])])]),_:1}),e(mt,{modelValue:u.value,"onUpdate:modelValue":n[5]||(n[5]=c=>u.value=c),"template-data":y.value,onSuccess:E},null,8,["modelValue","template-data"]),e(Mt,{modelValue:D.value,"onUpdate:modelValue":n[6]||(n[6]=c=>D.value=c),"template-data":y.value,onEdit:G},null,8,["modelValue","template-data"])])}}},Ht=ee(Pt,[["__scopeId","data-v-887d823e"]]);export{Ht as default};
//# sourceMappingURL=Templates-CR0bs0eI.js.map
