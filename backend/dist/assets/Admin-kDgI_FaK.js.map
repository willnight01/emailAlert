{"version":3,"file":"Admin-kDgI_FaK.js","sources":["../../src/views/Admin.vue"],"sourcesContent":["<template>\n  <div class=\"admin-container\">\n    <div class=\"page-header\">\n      <h1>用户管理</h1>\n      <p>管理系统用户账号</p>\n    </div>\n\n    <div class=\"content\">\n      <!-- 操作栏 -->\n      <div class=\"toolbar\">\n        <el-button type=\"primary\" @click=\"showCreateDialog\">\n          <el-icon><Plus /></el-icon>\n          添加用户\n        </el-button>\n        <el-button @click=\"loadUsers\">\n          <el-icon><Refresh /></el-icon>\n          刷新\n        </el-button>\n      </div>\n\n      <!-- 用户列表 -->\n      <el-table \n        :data=\"users\" \n        v-loading=\"loading\"\n        style=\"width: 100%\"\n        empty-text=\"暂无用户数据\"\n      >\n        <el-table-column prop=\"username\" label=\"用户名\" width=\"200\" />\n        <el-table-column prop=\"role\" label=\"角色\" width=\"120\">\n          <template #default=\"{ row }\">\n            <el-tag :type=\"row.role === 'admin' ? 'danger' : 'primary'\">\n              {{ row.role === 'admin' ? '管理员' : '普通用户' }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" width=\"200\">\n          <template #default=\"{ row }\">\n            <el-button \n              type=\"primary\" \n              size=\"small\" \n              @click=\"showEditDialog(row)\"\n              :disabled=\"row.username === currentUser\"\n            >\n              编辑\n            </el-button>\n            <el-button \n              type=\"danger\" \n              size=\"small\" \n              @click=\"deleteUser(row.username)\"\n              :disabled=\"row.username === currentUser\"\n            >\n              删除\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n\n    <!-- 创建/编辑用户对话框 -->\n    <el-dialog \n      :title=\"dialogTitle\" \n      v-model=\"dialogVisible\" \n      width=\"500px\"\n      @close=\"resetForm\"\n    >\n      <el-form \n        :model=\"userForm\" \n        :rules=\"userRules\" \n        ref=\"userFormRef\"\n        label-width=\"80px\"\n      >\n        <el-form-item label=\"用户名\" prop=\"username\">\n          <el-input \n            v-model=\"userForm.username\" \n            placeholder=\"请输入用户名\"\n            :disabled=\"isEdit\"\n          />\n        </el-form-item>\n        <el-form-item label=\"密码\" prop=\"password\">\n          <el-input \n            v-model=\"userForm.password\" \n            type=\"password\" \n            placeholder=\"请输入密码\"\n            show-password\n          />\n        </el-form-item>\n        <el-form-item label=\"角色\" prop=\"role\">\n          <el-select v-model=\"userForm.role\" placeholder=\"请选择角色\" style=\"width: 100%\">\n            <el-option label=\"管理员\" value=\"admin\" />\n            <el-option label=\"普通用户\" value=\"user\" />\n          </el-select>\n        </el-form-item>\n      </el-form>\n      \n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"dialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"submitForm\" :loading=\"submitting\">\n            {{ isEdit ? '更新' : '创建' }}\n          </el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, onMounted, computed } from 'vue'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport { Plus, Refresh } from '@element-plus/icons-vue'\nimport { useUserStore } from '@/store'\nimport { usersAPI } from '@/api'\n\nconst userStore = useUserStore()\n\n// 响应式数据\nconst users = ref([])\nconst loading = ref(false)\nconst dialogVisible = ref(false)\nconst submitting = ref(false)\nconst isEdit = ref(false)\nconst userFormRef = ref()\n\n// 当前用户名\nconst currentUser = computed(() => userStore.username)\n\n// 对话框标题\nconst dialogTitle = computed(() => isEdit.value ? '编辑用户' : '添加用户')\n\n// 用户表单数据\nconst userForm = reactive({\n  username: '',\n  password: '',\n  role: 'user'\n})\n\n// 表单验证规则\nconst userRules = {\n  username: [\n    { required: true, message: '请输入用户名', trigger: 'blur' },\n    { min: 3, max: 20, message: '用户名长度在 3 到 20 个字符', trigger: 'blur' }\n  ],\n  password: [\n    { required: true, message: '请输入密码', trigger: 'blur' },\n    { min: 4, max: 50, message: '密码长度在 4 到 50 个字符', trigger: 'blur' }\n  ],\n  role: [\n    { required: true, message: '请选择角色', trigger: 'change' }\n  ]\n}\n\n// 加载用户列表\nconst loadUsers = async () => {\n  loading.value = true\n  try {\n    const response = await usersAPI.list()\n    users.value = response.data || []\n  } catch (error) {\n    ElMessage.error('加载用户列表失败：' + (error.response?.data?.error || error.message))\n  } finally {\n    loading.value = false\n  }\n}\n\n// 显示创建用户对话框\nconst showCreateDialog = () => {\n  isEdit.value = false\n  dialogVisible.value = true\n  resetForm()\n}\n\n// 显示编辑用户对话框\nconst showEditDialog = (user) => {\n  isEdit.value = true\n  dialogVisible.value = true\n  userForm.username = user.username\n  userForm.password = '' // 编辑时密码为空，表示不修改\n  userForm.role = user.role\n}\n\n// 重置表单\nconst resetForm = () => {\n  if (userFormRef.value) {\n    userFormRef.value.resetFields()\n  }\n  userForm.username = ''\n  userForm.password = ''\n  userForm.role = 'user'\n}\n\n// 提交表单\nconst submitForm = async () => {\n  if (!userFormRef.value) return\n  \n  const valid = await userFormRef.value.validate().catch(() => false)\n  if (!valid) return\n\n  submitting.value = true\n  try {\n    if (isEdit.value) {\n      // 更新用户\n      await usersAPI.update(userForm.username, {\n        username: userForm.username,\n        password: userForm.password,\n        role: userForm.role\n      })\n      ElMessage.success('用户更新成功')\n    } else {\n      // 创建用户\n      await usersAPI.create({\n        username: userForm.username,\n        password: userForm.password,\n        role: userForm.role\n      })\n      ElMessage.success('用户创建成功')\n    }\n    \n    dialogVisible.value = false\n    loadUsers()\n  } catch (error) {\n    ElMessage.error((isEdit.value ? '更新' : '创建') + '用户失败：' + (error.response?.data?.error || error.message))\n  } finally {\n    submitting.value = false\n  }\n}\n\n// 删除用户\nconst deleteUser = async (username) => {\n  try {\n    await ElMessageBox.confirm(\n      `确定要删除用户 \"${username}\" 吗？此操作不可撤销。`,\n      '确认删除',\n      {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }\n    )\n    \n    await usersAPI.delete(username)\n    ElMessage.success('用户删除成功')\n    loadUsers()\n  } catch (error) {\n    if (error !== 'cancel') {\n      ElMessage.error('删除用户失败：' + (error.response?.data?.error || error.message))\n    }\n  }\n}\n\n// 组件挂载时加载数据\nonMounted(() => {\n  loadUsers()\n})\n</script>\n\n<style scoped>\n.admin-container {\n  padding: 20px;\n}\n\n.page-header {\n  margin-bottom: 20px;\n}\n\n.page-header h1 {\n  margin: 0 0 8px 0;\n  font-size: 24px;\n  font-weight: 600;\n  color: var(--el-text-color-primary);\n}\n\n.page-header p {\n  margin: 0;\n  color: var(--el-text-color-regular);\n  font-size: 14px;\n}\n\n.content {\n  background: var(--el-bg-color);\n  border-radius: 8px;\n  padding: 20px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.toolbar {\n  margin-bottom: 20px;\n  display: flex;\n  gap: 12px;\n}\n\n.dialog-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n}\n\n:deep(.el-table) {\n  --el-table-border-color: var(--el-border-color-lighter);\n}\n\n:deep(.el-table th) {\n  background-color: var(--el-fill-color-light);\n}\n</style> "],"names":["userStore","useUserStore","users","ref","loading","dialogVisible","submitting","isEdit","userFormRef","currentUser","computed","dialogTitle","userForm","reactive","userRules","loadUsers","response","usersAPI","error","ElMessage","_b","_a","showCreateDialog","resetForm","showEditDialog","user","submitForm","deleteUser","username","ElMessageBox","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_el_button","_component_el_icon","_unref","Plus","Refresh","_createBlock","_component_el_table","_component_el_table_column","_withCtx","row","_component_el_tag","_createTextVNode","_toDisplayString","$event","_cache","_component_el_dialog","_hoisted_4","_component_el_form","_component_el_form_item","_component_el_input","_component_el_select","_component_el_option"],"mappings":"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"}